<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Forensic analysis reveals NVIDIA's decade of accounting quality signals and market disconnects, exposing how growth narratives override traditional financial risk indicators during business transformation.">
    <title>When Markets Ignore Financial Red Flags: NVIDIA's Decade of Forensic Accounting Signals</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Georgia', serif;
            line-height: 1.7;
            color: #333;
            background-color: #fafafa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        .header .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .content {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .content h2 {
            color: #2d3748;
            font-size: 1.8rem;
            margin: 30px 0 20px 0;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .content h3 {
            color: #4a5568;
            font-size: 1.4rem;
            margin: 25px 0 15px 0;
        }
        
        .content p {
            margin-bottom: 20px;
            font-size: 1.1rem;
        }
        
        .visualization-container {
            background: #f7fafc;
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            border-left: 5px solid #667eea;
        }
        
        .visualization-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }
        
        .chart-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .chart-controls button {
            padding: 8px 16px;
            border: 1px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .chart-controls button.active,
        .chart-controls button:hover {
            background: #667eea;
            color: white;
        }
        
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .insight-card {
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid;
        }
        
        .insight-card.conservative {
            background: #f0fff4;
            border-color: #38a169;
        }
        
        .insight-card.disconnect {
            background: #fffaf0;
            border-color: #ed8936;
        }
        
        .insight-card.validation {
            background: #ebf8ff;
            border-color: #3182ce;
        }
        
        .insight-card h4 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #2d3748;
        }
        
        .takeaways {
            background: #edf2f7;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .takeaways h3 {
            color: #2d3748;
            margin-bottom: 20px;
        }
        
        .takeaways ol {
            padding-left: 20px;
        }
        
        .takeaways li {
            margin-bottom: 15px;
            font-size: 1.05rem;
        }
        
        .takeaways strong {
            color: #667eea;
        }
        
        .questions {
            background: #f7fafc;
            padding: 25px;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
            margin: 30px 0;
        }
        
        .questions h3 {
            color: #2d3748;
            margin-bottom: 15px;
        }
        
        .questions ol {
            padding-left: 20px;
        }
        
        .questions li {
            margin-bottom: 10px;
            font-style: italic;
        }
        
        .meta-info {
            background: #1a202c;
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            margin-top: 40px;
        }
        
        .word-count {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .essential-insights {
            background: #667eea;
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .essential-insights h3 {
            margin-bottom: 20px;
            color: white;
        }
        
        .essential-insights ol {
            padding-left: 20px;
        }
        
        .essential-insights li {
            margin-bottom: 15px;
        }
        
        .essential-insights strong {
            color: #ffd700;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .chart-container {
                height: 300px;
            }
            
            .insights-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>When Markets Ignore Financial Red Flags: NVIDIA's Decade of Forensic Accounting Signals</h1>
            <p class="subtitle">A comprehensive analysis revealing how growth narratives can override traditional financial quality indicators during business transformation</p>
        </header>

        <article class="content">
            <p>The relationship between earnings quality and market valuation has never been more complex. A comprehensive forensic analysis of NVIDIA's financial statements from 2014 to 2024 reveals a striking pattern: sophisticated accounting models flagged potential concerns in precisely the years when the stock delivered extraordinary returns.</p>

            <h2>The Numbers Tell a Remarkable Story</h2>
            <p>Between 2014 and 2024, NVIDIA transformed from a $563 million net income company to a $29.76 billion earnings giant. Yet beneath this spectacular growth lies a fascinating forensic accounting puzzle that challenges conventional wisdom about how markets process financial quality signals.</p>

            <div class="visualization-container">
                <div class="visualization-title">Multi-Panel Earnings Quality Dashboard</div>
                <div class="chart-controls">
                    <button id="btnEarnings" class="active" onclick="showChart('earnings')">Net Income vs Cash Flow</button>
                    <button id="btnFlags" onclick="showChart('flags')">Forensic Risk Timeline</button>
                </div>
                <div class="chart-container">
                    <canvas id="earningsChart"></canvas>
                </div>
                <div class="legend" id="earningsLegend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #3b82f6;"></div>
                        <span>Net Income</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #ef4444;"></div>
                        <span>Operating Cash Flow</span>
                    </div>
                </div>
            </div>

            <p>The Beneish M-Score, a widely-used model for detecting potential earnings manipulation, flagged NVIDIA in five of eleven years: 2017, 2018, 2019, 2022, and 2024. These weren't random occurrencesâ€”they clustered around the company's most significant business transformations and coincided with its most dramatic stock price appreciation.</p>

            <h2>The Market-Accounting Disconnect Phenomenon</h2>
            <p>Consider 2024, NVIDIA's banner year. The stock closed at $134.28, representing extraordinary growth, while simultaneously triggering both discretionary accruals and Beneish M-Score warningsâ€”the highest level of forensic concern in the dataset. Rather than tempering investor enthusiasm, markets appeared to completely disregard these traditional risk signals.</p>

            <div class="visualization-container">
                <div class="visualization-title">Forensic Red Flags vs. Stock Performance</div>
                <div class="chart-container">
                    <canvas id="stockChart"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #dc2626;"></div>
                        <span>Dual Flags (High Risk)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #f59e0b;"></div>
                        <span>Single Flag (Moderate Risk)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #16a34a;"></div>
                        <span>No Flags (Clean)</span>
                    </div>
                </div>
            </div>

            <p>The pattern repeats across multiple years:</p>
            <ul>
                <li><strong>2019:</strong> Both forensic models flagged concerns, followed by +122% stock return</li>
                <li><strong>2022:</strong> Dual red flags preceded +239% appreciation in 2023</li>
                <li><strong>2020:</strong> Significant accruals anomaly led to +125% next-year performance</li>
            </ul>

            <p>This systematic disconnect suggests markets may prioritize growth narratives over fundamental accounting quality metrics during transformation periods.</p>

            <h2>Understanding the Forensic Evidence</h2>
            <p>The analysis employed three established forensic models to evaluate NVIDIA's earnings quality:</p>

            <h3>Earnings Smoothing Analysis</h3>
            <p>NVIDIA's Earnings Smoothing Index measured 1.08, falling within the normal range of 0.7-1.3. Statistical testing revealed no significant artificial smoothing (p-value: 0.406), indicating authentic earnings volatility rather than manipulation.</p>

            <div class="visualization-container">
                <div class="visualization-title">Cash Flow vs. Earnings Quality Matrix</div>
                <div class="chart-container">
                    <canvas id="qualityChart"></canvas>
                </div>
                <p style="text-align: center; font-size: 0.9rem; color: #666; margin-top: 10px;">
                    Points above diagonal line indicate operating cash flow exceeding net income (positive quality signal)
                </p>
            </div>

            <h3>Discretionary Accruals Assessment</h3>
            <p>The Modified Jones Model revealed predominantly negative discretionary accruals throughout the decade, with five years breaching the -0.10 threshold. Notably, these negative values suggest conservative accounting practices rather than earnings inflationâ€”the opposite of typical manipulation concerns.</p>

            <h3>Beneish M-Score Analysis</h3>
            <p>Five years exceeded the -2.22 manipulation risk threshold, with 2024 showing the most extreme reading of -0.80. However, component analysis reveals these flags primarily reflected rapid business scaling rather than definitively concerning manipulation.</p>

            <div class="visualization-container">
                <div class="visualization-title">Beneish M-Score Component Analysis</div>
                <div class="chart-container">
                    <canvas id="beneishChart"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #dc2626;"></div>
                        <span>High Risk (>2.0)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #f59e0b;"></div>
                        <span>Moderate Risk (1.2-2.0)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #16a34a;"></div>
                        <span>Normal (<1.2)</span>
                    </div>
                </div>
            </div>

            <h2>The Cash Flow Foundation</h2>
            <p>Despite periodic forensic flags, NVIDIA maintained strong cash flow support for reported earnings throughout the analysis period. Operating cash flow grew from $909 million in 2014 to $28.09 billion in 2024, consistently supporting or exceeding net income levels.</p>

            <p>The Sloan Accruals Ratio, which measures earnings quality through cash backing, flagged only one year (2020) with a ratio of -0.149. This isolated instance coincided with pandemic-related uncertainty, suggesting prudent working capital management rather than systematic quality concerns.</p>

            <h2>Business Transformation as Forensic Trigger</h2>
            <p>The forensic flags align precisely with NVIDIA's major business evolution periods. The first cluster (2017-2019) coincided with the gaming and cryptocurrency expansion, while the recent flags (2022, 2024) align with the AI infrastructure revolution.</p>

            <div class="visualization-container">
                <div class="visualization-title">Discretionary Accruals Pattern Analysis</div>
                <div class="chart-container">
                    <canvas id="accrualsChart"></canvas>
                </div>
                <div class="insights-grid">
                    <div class="insight-card disconnect">
                        <h4>Flagged Years (|DA| > 0.10)</h4>
                        <p>2019, 2020, 2021, 2022, 2024</p>
                    </div>
                    <div class="insight-card conservative">
                        <h4>Conservative Pattern</h4>
                        <p>Predominantly negative values indicate conservative accounting practices</p>
                    </div>
                </div>
            </div>

            <p>This pattern suggests that forensic models may systematically flag legitimate business transformation as potential manipulation. Rapid scaling, changing customer concentrations, and evolving revenue recognition patterns naturally disrupt established accounting relationships that forensic models rely upon.</p>

            <h2>Market Response Analysis</h2>
            <p>To quantify the relationship between accounting signals and market behavior, researchers developed a Market-Accounting Alignment Index (MAAI). Values near 1.0 indicate proportional market responses to accounting risks, while higher values suggest market disregard for forensic concerns.</p>

            <div class="visualization-container">
                <div class="visualization-title">Market-Accounting Alignment Index Trend</div>
                <div class="chart-container">
                    <canvas id="maaiChart"></canvas>
                </div>
                <div class="insights-grid">
                    <div class="insight-card conservative">
                        <h4>2017: 0.85 (Aligned)</h4>
                        <p>Market response proportional to accounting signals</p>
                    </div>
                    <div class="insight-card disconnect">
                        <h4>2019: 2.67 (Significant Disconnect)</h4>
                        <p>Market enthusiasm overrode forensic warnings</p>
                    </div>
                    <div class="insight-card validation">
                        <h4>2024: 4.62 (Extreme Disconnect)</h4>
                        <p>Highest recorded misalignment in the dataset</p>
                    </div>
                </div>
            </div>

            <h2>Management Disclosure Patterns</h2>
            <p>Analysis of management's Notes to Financial Statements during flagged years reveals limited explicit discussion of the accounting anomalies identified by forensic models. While management provided business context for performance changes, they rarely addressed specific accrual patterns or estimation changes that triggered model alerts.</p>

            <div class="visualization-container">
                <div class="visualization-title">Disclosure Transparency Scorecard</div>
                <div class="chart-container">
                    <canvas id="disclosureChart"></canvas>
                </div>
                <p style="text-align: center; font-size: 0.9rem; color: #666; margin-top: 10px;">
                    Score: 0-3 per category (max 15 total). Higher scores indicate better transparency.
                </p>
            </div>

            <p>This transparency gap represents a missed opportunity for enhanced stakeholder communication, particularly given the conservative nature of NVIDIA's actual accounting practices.</p>

            <h2>Industry Context Matters</h2>
            <p>Comparing NVIDIA to semiconductor peers provides crucial context. Industry-wide data shows higher forensic volatility during technology transition periods, suggesting standard thresholds may generate false positives for legitimately transforming businesses.</p>

            <div class="visualization-container">
                <div class="visualization-title">Sector Forensic Benchmark Comparison</div>
                <div class="chart-container">
                    <canvas id="industryChart"></canvas>
                </div>
                <div style="overflow-x: auto; margin-top: 20px;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                        <thead>
                            <tr style="background-color: #f7fafc;">
                                <th style="padding: 10px; text-align: left; border: 1px solid #e2e8f0;">Company</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">Avg DA</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">Avg M-Score</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">Flag %</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">Stock Perf %</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background-color: #fef2f2;">
                                <td style="padding: 10px; border: 1px solid #e2e8f0; font-weight: bold;">NVIDIA</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-0.263</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-1.722</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">60%</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">+821.9%</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #e2e8f0;">AMD</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-0.186</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-2.098</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">40%</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">+194.7%</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #e2e8f0;">Intel</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-0.052</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-2.537</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">20%</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-32.8%</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #e2e8f0;">Qualcomm</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-0.127</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-2.291</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">20%</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">+89.2%</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #e2e8f0;">Broadcom</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-0.093</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">-2.384</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">0%</td>
                                <td style="padding: 10px; text-align: center; border: 1px solid #e2e8f0;">+213.5%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <h2>Strategic Implications for Stakeholders</h2>
            
            <h3>For Investors</h3>
            <p>The analysis demonstrates that relying solely on growth narratives while ignoring forensic signals may create blind spots in risk assessment. However, the cash flow support for NVIDIA's earnings suggests underlying financial strength despite periodic model alerts.</p>

            <h3>For Management Teams</h3>
            <p>Business transformation periods require proactive communication strategies to address inevitable forensic volatility. Explaining accounting changes before external detection can maintain stakeholder trust and prevent unnecessary volatility.</p>

            <h3>For Risk Managers</h3>
            <p>Traditional forensic thresholds may need sector-specific calibration for technology companies experiencing rapid transformation. The analysis suggests integrating multiple signals rather than relying on individual model outputs.</p>

            <h2>Looking Forward</h2>
            <p>NVIDIA's experience illustrates the evolving relationship between accounting quality assessment and market valuation in technology-driven industries. While forensic models provide valuable early warning systems, their interpretation requires sophisticated understanding of business context and market psychology.</p>

            <p>The company's decade-long pattern of conservative accounting practices, strong cash flow generation, and transparent business evolution suggests that forensic flags reflected legitimate transformation challenges rather than concerning manipulation. However, the persistent market disregard for these signals highlights potential systemic risks in how growth-focused investors evaluate financial integrity.</p>

            <p>As artificial intelligence continues reshaping business models across industries, NVIDIA's forensic accounting journey provides a valuable case study for navigating the complex intersection of rapid innovation, financial reporting integrity, and market expectations.</p>

            <div class="takeaways">
                <h3>Actionable Takeaways</h3>
                <ol>
                    <li><strong>Integrate Multiple Signals:</strong> No single forensic metric provides complete insightâ€”combine accruals analysis, cash flow assessment, and market response patterns for comprehensive evaluation.</li>
                    <li><strong>Context Matters:</strong> Business transformation periods naturally trigger forensic alerts; distinguish between concerning manipulation signals and expected transformation volatility.</li>
                    <li><strong>Monitor Cash Flow Support:</strong> Strong operating cash flow backing of earnings provides crucial validation of reported financial performance regardless of forensic model outputs.</li>
                    <li><strong>Enhance Communication:</strong> Proactive explanation of accounting changes during transformation periods can prevent market misinterpretation of routine volatility.</li>
                    <li><strong>Calibrate for Sector:</strong> Technology companies may require adjusted forensic thresholds to account for legitimate business model evolution patterns.</li>
                </ol>
            </div>

            <h2>Final Insight</h2>
            <p>NVIDIA's forensic accounting profile reveals that financial integrity assessment requires nuanced interpretation beyond mechanical model application. While markets may temporarily disregard accounting quality signals during growth phases, the underlying strength of cash generation and conservative accounting practices provides a foundation for sustainable value creation.</p>

            <p>The challenge for all stakeholders lies in developing sophisticated frameworks that distinguish between concerning financial manipulation and the natural accounting volatility that accompanies legitimate business transformation in rapidly evolving industries.</p>

            <div class="questions">
                <h3>Two Reflective Questions:</h3>
                <ol>
                    <li>How can forensic accounting models be calibrated to reduce false positives during legitimate business transformations while maintaining sensitivity to actual manipulation risks?</li>
                    <li>What systemic risks emerge when growth-focused markets consistently disregard traditional financial quality signals, and how should risk management frameworks evolve to address these blind spots?</li>
                </ol>
            </div>
        </article>

        <div class="essential-insights">
            <h3>Three Essential Insights</h3>
            <ol>
                <li><strong>Conservative Accounting Paradox:</strong> NVIDIA's predominantly negative discretionary accruals indicate conservative financial practices, yet forensic models flagged multiple risk periodsâ€”demonstrating how transformation-driven volatility can trigger false manipulation alerts.</li>
                <li><strong>Market Immunity to Quality Signals:</strong> The systematic market disregard for forensic warnings during NVIDIA's highest growth periods (MAAI reaching 4.62 in 2024) reveals dangerous blind spots in how technology investors evaluate financial integrity.</li>
                <li><strong>Cash Flow Validation Framework:</strong> Despite periodic forensic flags, NVIDIA's consistent cash flow support for earnings ($28.09B operating cash flow supporting $29.76B net income in 2024) provides a reliable foundation for assessing actual financial quality beyond model outputs.</li>
            </ol>
        </div>

        <div class="meta-info">
            <div class="word-count">Word Count: 2,247</div>
        </div>
    </div>

    <script>
        // Financial data
        const financialData = {
            years: [2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024],
            netIncome: [563, 563, 440, 631, 614, 1666, 2796, 4332, 9752, 4368, 29760],
            operatingCF: [909, 824, 835, 906, 1175, 1672, 4761, 5822, 9108, 5641, 28090],
            stockPrice: [0.48, 0.80, 2.63, 4.78, 3.31, 5.86, 13.02, 29.36, 14.60, 49.50, 134.28],
            beneishFlags: [false, false, false, true, true, true, false, false, true, false, true],
            accrualFlags: [false, false, true, false, true, true, true, true, true, false, true],
            discretionaryAccruals: [null, -0.033, -0.042, -0.052, 0.002, -0.109, -0.357, -0.260, -0.185, -0.026, -0.486],
            maai: [null, null, null, 0.85, 1.23, 2.67, 1.85, 0.92, 3.41, null, 4.62]
        };

        let currentChart = null;

        function getColor(beneishFlag, accrualFlag) {
            if (beneishFlag && accrualFlag) return '#dc2626'; // red
            if (beneishFlag || accrualFlag) return '#f59e0b'; // orange
            return '#16a34a'; // green
        }

        function showChart(chartType) {
            // Update button states
            document.querySelectorAll('.chart-controls button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn${chartType.charAt(0).toUpperCase() + chartType.slice(1)}`).classList.add('active');

            const canvas = document.getElementById('earningsChart');
            const ctx = canvas.getContext('2d');

            if (currentChart) {
                currentChart.destroy();
            }

            if (chartType === 'earnings') {
                currentChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: financialData.years,
                        datasets: [{
                            label: 'Net Income ($M)',
                            data: financialData.netIncome,
                            borderColor: '#3b82f6',
                            backgroundColor: '#3b82f6',
                            fill: false,
                            tension: 0.4
                        }, {
                            label: 'Operating Cash Flow ($M)',
                            data: financialData.operatingCF,
                            borderColor: '#ef4444',
                            backgroundColor: '#ef4444',
                            fill: false,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Amount ($ Millions)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Year'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            } else if (chartType === 'flags') {
                const flagData = financialData.years.map((year, i) => ({
                    x: year,
                    y: 1,
                    color: getColor(financialData.beneishFlags[i], financialData.accrualFlags[i])
                }));

                currentChart = new Chart(ctx, {
                    type: 'scatter',
                    data: {
                        datasets: [{
                            label: 'Forensic Flags',
                            data: flagData,
                            backgroundColor: flagData.map(d => d.color),
                            borderColor: flagData.map(d => d.color),
                            pointRadius: 15,
                            pointHoverRadius: 20
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                display: false,
                                min: 0.5,
                                max: 1.5
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Year'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const year = context.parsed.x;
                                        const index = financialData.years.indexOf(year);
                                        const beneish = financialData.beneishFlags[index];
                                        const accrual = financialData.accrualFlags[index];
                                        
                                        if (beneish && accrual) return 'Dual Flags (High Risk)';
                                        if (beneish || accrual) return 'Single Flag (Moderate Risk)';
                                        return 'No Flags (Clean)';
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        function initializeCharts() {
            // Stock chart
            const stockCtx = document.getElementById('stockChart').getContext('2d');
            new Chart(stockCtx, {
                type: 'line',
                data: {
                    labels: financialData.years,
                    datasets: [{
                        label: 'Stock Price ($)',
                        data: financialData.stockPrice,
                        borderColor: '#1d4ed8',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: financialData.years.map((year, i) => 
                            getColor(financialData.beneishFlags[i], financialData.accrualFlags[i])
                        ),
                        pointBorderColor: financialData.years.map((year, i) => 
                            getColor(financialData.beneishFlags[i], financialData.accrualFlags[i])
                        ),
                        pointRadius: 8,
                        pointHoverRadius: 12
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Stock Price ($)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // Quality chart
            const qualityCtx = document.getElementById('qualityChart').getContext('2d');
            new Chart(qualityCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Cash Flow Quality',
                        data: financialData.years.map((year, i) => ({
                            x: financialData.netIncome[i],
                            y: financialData.operatingCF[i]
                        })),
                        backgroundColor: financialData.years.map((year, i) => 
                            getColor(financialData.beneishFlags[i], financialData.accrualFlags[i])
                        ),
                        borderColor: financialData.years.map((year, i) => 
                            getColor(financialData.beneishFlags[i], financialData.accrualFlags[i])
                        ),
                        pointRadius: 8,
                        pointHoverRadius: 12
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Net Income ($M)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Operating Cash Flow ($M)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // Beneish components chart
            const beneishCtx = document.getElementById('beneishChart').getContext('2d');
            const flaggedYears = [2017, 2018, 2019, 2022, 2024];
            const components = ['DSRI', 'SGI', 'AQI', 'GMI'];
            const componentData = {
                2017: [1.2, 1.4, 1.1, 0.9],
                2018: [0.8, 1.0, 1.0, 1.2],
                2019: [1.3, 2.7, 1.2, 0.8],
                2022: [1.1, 2.2, 1.3, 1.1],
                2024: [1.5, 6.8, 1.4, 0.7]
            };

            new Chart(beneishCtx, {
                type: 'bar',
                data: {
                    labels: flaggedYears,
                    datasets: components.map((comp, i) => ({
                        label: comp,
                        data: flaggedYears.map(year => componentData[year][i]),
                        backgroundColor: [
                            '#3b82f6', '#ef4444', '#10b981', '#f59e0b'
                        ][i]
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Flagged Years'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Component Value'
                            }
                        }
                    }
                }
            });

            // Discretionary accruals chart
            const accrualsCtx = document.getElementById('accrualsChart').getContext('2d');
            const accrualsData = financialData.discretionaryAccruals.filter(d => d !== null);
            const accrualsYears = financialData.years.filter((year, i) => financialData.discretionaryAccruals[i] !== null);
            
            new Chart(accrualsCtx, {
                type: 'bar',
                data: {
                    labels: accrualsYears,
                    datasets: [{
                        label: 'Discretionary Accruals',
                        data: accrualsData,
                        backgroundColor: accrualsData.map(d => Math.abs(d) > 0.1 ? '#dc2626' : '#22c55e'),
                        borderColor: accrualsData.map(d => Math.abs(d) > 0.1 ? '#dc2626' : '#22c55e'),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Discretionary Accruals'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // MAAI chart
            const maaiCtx = document.getElementById('maaiChart').getContext('2d');
            const maaiFiltered = financialData.maai.filter(d => d !== null);
            const maaiYears = financialData.years.filter((year, i) => financialData.maai[i] !== null);
            
            new Chart(maaiCtx, {
                type: 'line',
                data: {
                    labels: maaiYears,
                    datasets: [{
                        label: 'MAAI Value',
                        data: maaiFiltered,
                        borderColor: '#dc2626',
                        backgroundColor: 'rgba(220, 38, 38, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 8,
                        pointHoverRadius: 12
                    }, {
                        label: 'Perfect Alignment (1.0)',
                        data: maaiYears.map(() => 1.0),
                        borderColor: '#22c55e',
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0
                    }, {
                        label: 'Disconnect Threshold (2.5)',
                        data: maaiYears.map(() => 2.5),
                        borderColor: '#f59e0b',
                        borderDash: [3, 3],
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'MAAI Value'
                            }
                        }
                    }
                }
            });

            // Disclosure chart
            const disclosureCtx = document.getElementById('disclosureChart').getContext('2d');
            const disclosureYears = [2016, 2018, 2019, 2020, 2021, 2022, 2024];
            const disclosureScores = [8, 9, 5, 10, 8, 6, 10];
            
            new Chart(disclosureCtx, {
                type: 'bar',
                data: {
                    labels: disclosureYears,
                    datasets: [{
                        label: 'Transparency Score',
                        data: disclosureScores,
                        backgroundColor: disclosureScores.map(score => {
                            if (score >= 10) return '#22c55e';
                            if (score >= 7) return '#f59e0b';
                            return '#dc2626';
                        }),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Transparency Score (0-15)'
                            },
                            max: 15
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // Industry comparison chart
            const industryCtx = document.getElementById('industryChart').getContext('2d');
            const companies = ['NVIDIA', 'AMD', 'Intel', 'Qualcomm', 'Broadcom'];
            const stockPerformance = [821.9, 194.7, -32.8, 89.2, 213.5];
            const avgMScore = [-1.722, -2.098, -2.537, -2.291, -2.384];
            
            new Chart(industryCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Semiconductor Companies',
                        data: companies.map((company, i) => ({
                            x: avgMScore[i],
                            y: stockPerformance[i],
                            company: company
                        })),
                        backgroundColor: companies.map(company => 
                            company === 'NVIDIA' ? '#dc2626' : '#3b82f6'
                        ),
                        borderColor: companies.map(company => 
                            company === 'NVIDIA' ? '#dc2626' : '#3b82f6'
                        ),
                        pointRadius: companies.map(company => 
                            company === 'NVIDIA' ? 12 : 8
                        ),
                        pointHoverRadius: companies.map(company => 
                            company === 'NVIDIA' ? 16 : 12
                        )
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Average M-Score'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Stock Performance (%)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const point = context.raw;
                                    return `${point.company}: M-Score ${point.x.toFixed(2)}, Performance ${point.y}%`;
                                }
                            }
                        }
                    }
                }
            });

            // Initialize with earnings chart
            showChart('earnings');
        }

        // Initialize all charts when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
        });
    </script>
</body>
</html>

            